# ==============================================================
# CONFIGURACIÓN DEL SERVIDOR
# ==============================================================
spring.application.name=notification-service
# Cloud Run inyecta la variable PORT automáticamente (usualmente 8080). 
# Si no la inyecta, usamos 8088 por defecto.
server.port=${PORT:8088}

# ==============================================================
# BASE DE DATOS (PostgreSQL)
# ==============================================================
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.open-in-view=false

# ==============================================================
# SEGURIDAD (JWT) - ⚠️ AQUÍ ESTABA EL ERROR
# ==============================================================
# Mapeamos la variable de entorno JWT_SECRET (del Pipeline) 
# a la propiedad que busca el JwtAuthenticationFilter.
application.security.jwt.secret-key=${JWT_SECRET}

# ==============================================================
# GOOGLE CLOUD PUB/SUB
# ==============================================================
spring.cloud.gcp.pubsub.enabled=true
spring.cloud.gcp.project-id=${PROJECT_ID}

# ==============================================================
# NOTIFICACIONES: RESEND (Email)
# ==============================================================
resend.api.key=${RESEND_API_KEY}
resend.from.email=${RESEND_FROM_EMAIL:noreply@quhealthy.com}

# ==============================================================
# NOTIFICACIONES: TWILIO (SMS & WhatsApp)
# ==============================================================
twilio.account.sid=${TWILIO_SID}
twilio.auth.token=${TWILIO_TOKEN}
twilio.phone.number=${TWILIO_PHONE_NUMBER}

# ==============================================================
# ACTUATOR & LOGGING
# ==============================================================
management.endpoints.web.exposure.include=health,info,metrics
logging.level.root=INFO
logging.level.com.quhealthy.notification_service=DEBUG
# Para ver detalles de errores de seguridad si fallan
logging.level.org.springframework.security=ERROR